{% extends "auctions/layout.html" %}

{% block body %}
    <div class='listing-page'>
        <h3>Listing: {{ listing.title }}</h3>
        <form action={% url 'watchlist' %} method='post'>
            {% csrf_token %}
            <input type="hidden" name="id" value="{{ listing.id }}">
            <button class='watchlist btn btn-info'>Watchlist</button>
        </form>
        <img src={{ listing.image.url }} alt={{listing.title}}>
        <p>{{ listing.description }}</p>
        <h4>${{ highest_bid|floatformat:2 }}</h4>
        
        {% if bidder == user %}
            <p>{{ bids }} bid(s) so far. Your Bid is current bid.</p>
        {% else %}
            <p>{{ bids }} bid(s) so far. Current bidder: {{ bidder }}</p>
        {% endif %}
        
        {% if user.is_authenticated %}
            {% if user ==  listing.seller %}
                <form>
                    <button class='place-bid btn btn-primary'>Close Bidding</button>
                </form>
            {% else %}
                <form action={% url 'bid' listing.id %} method='post'>
                    {% csrf_token %}
                    <input name='bid' type='number' min={{ highest_bid }} placeholder='Bid' step="0.01">
                    <button class='place-bid btn btn-primary'>Place Bid</button>
                </form>
            {% endif %}
        {% endif %}
        
        <h5>Details</h5>
            <ul>
                <li> Listed by: {{ listing.seller }}</li>
                <li> Category: {{ listing.category }}</li> 
            </ul>
    </div>
{% endblock %}